<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Programming the V80 - Vollo SDK User Guide</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="assets/vollo-favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <a href="./">
                  <img class="sidebar-logo">
                  </img>
                </a>

                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="key-features.html"><strong aria-hidden="true">2.</strong> Key Features</a></li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="vollo-compiler.html"><strong aria-hidden="true">4.</strong> Vollo Compiler</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api.html"><strong aria-hidden="true">4.1.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="supported-models.html"><strong aria-hidden="true">4.2.</strong> Supported Models</a></li><li class="chapter-item expanded "><a href="example-1-mlp.html"><strong aria-hidden="true">4.3.</strong> Example 1: MLP</a></li><li class="chapter-item expanded "><a href="example-2-cnn.html"><strong aria-hidden="true">4.4.</strong> Example 2: CNN</a></li><li class="chapter-item expanded "><a href="example-3-multi-model.html"><strong aria-hidden="true">4.5.</strong> Example 3: Multiple Models in a Vollo Program</a></li><li class="chapter-item expanded "><a href="vollo-onnx.html"><strong aria-hidden="true">4.6.</strong> ONNX Support</a></li></ol></li><li class="chapter-item expanded "><a href="benchmark.html"><strong aria-hidden="true">5.</strong> Benchmarks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="benchmark-mlp.html"><strong aria-hidden="true">5.1.</strong> MLP</a></li><li class="chapter-item expanded "><a href="benchmark-cnn.html"><strong aria-hidden="true">5.2.</strong> CNN</a></li><li class="chapter-item expanded "><a href="benchmark-lstm.html"><strong aria-hidden="true">5.3.</strong> LSTM</a></li><li class="chapter-item expanded "><a href="benchmark-io.html"><strong aria-hidden="true">5.4.</strong> IO Round Trip</a></li></ol></li><li class="chapter-item expanded "><a href="accelerator-setup.html"><strong aria-hidden="true">6.</strong> Accelerator Setup</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="system-requirements.html"><strong aria-hidden="true">6.1.</strong> System Requirements</a></li><li class="chapter-item expanded "><a href="programming-the-agilex.html"><strong aria-hidden="true">6.2.</strong> Programming the Agilex</a></li><li class="chapter-item expanded "><a href="programming-the-v80.html" class="active"><strong aria-hidden="true">6.3.</strong> Programming the V80</a></li><li class="chapter-item expanded "><a href="licensing.html"><strong aria-hidden="true">6.4.</strong> Licensing</a></li><li class="chapter-item expanded "><a href="running-an-example.html"><strong aria-hidden="true">6.5.</strong> Running an Example</a></li><li class="chapter-item expanded "><a href="running-the-benchmark.html"><strong aria-hidden="true">6.6.</strong> Running the Benchmark</a></li></ol></li><li class="chapter-item expanded "><a href="vollo-runtime.html"><strong aria-hidden="true">7.</strong> Vollo Runtime</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="c-api.html"><strong aria-hidden="true">7.1.</strong> C API</a></li><li class="chapter-item expanded "><a href="vollo-rt-example.html"><strong aria-hidden="true">7.2.</strong> C Example</a></li><li class="chapter-item expanded "><a href="vollo-rt-python-example.html"><strong aria-hidden="true">7.3.</strong> Python Example</a></li></ol></li><li class="chapter-item expanded "><a href="ip-core/0-intro.html"><strong aria-hidden="true">8.</strong> Vollo IP Core</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ip-core/1-selecting-an-ip-core.html"><strong aria-hidden="true">8.1.</strong> Selecting an IP Core</a></li><li class="chapter-item expanded "><a href="ip-core/2-interface.html"><strong aria-hidden="true">8.2.</strong> IP Core Interface</a></li><li class="chapter-item expanded "><a href="ip-core/3-quartus-integration.html"><strong aria-hidden="true">8.3.</strong> Quartus Integration</a></li><li class="chapter-item expanded "><a href="ip-core/4-config.html"><strong aria-hidden="true">8.4.</strong> Runtime configuration</a></li><li class="chapter-item expanded "><a href="ip-core/5-example-design.html"><strong aria-hidden="true">8.5.</strong> Example design</a></li></ol></li><li class="chapter-item expanded "><a href="versions.html"><strong aria-hidden="true">9.</strong> Versions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="release-notes.html"><strong aria-hidden="true">9.1.</strong> Release Notes</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Vollo SDK User Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="programming-the-v80-fpga"><a class="header" href="#programming-the-v80-fpga">Programming the V80 FPGA</a></h1>
<h2 id="download-the-bitstream-for-your-fpga"><a class="header" href="#download-the-bitstream-for-your-fpga">Download the bitstream for your FPGA</a></h2>
<p>The bitstream is available on the <a href="https://github.com/MyrtleSoftware/vollo-sdk/releases/">Github Release page</a> alongside the Vollo SDK. For example to
download the bitstream for the AMD <code>v80</code> board with the <code>c6b32</code> configuration of Vollo:</p>
<pre><code class="language-sh">curl -LO https://github.com/MyrtleSoftware/vollo-sdk/releases/download/v24.0.0/vollo-amd-v80-c6b32-24.0.tar.gz
mkdir -p $VOLLO_SDK/bitstream
tar -xzf vollo-amd-v80-c6b32-24.0.tar.gz -C $VOLLO_SDK/bitstream
</code></pre>
<h2 id="programming-the-fpga-over-pcie"><a class="header" href="#programming-the-fpga-over-pcie">Programming the FPGA over PCIe</a></h2>
<p>If your FPGA is already programmed with the Vollo accelerator then you can update the bitstream over
PCIe. You can check if the device is programmed with the Myrtle.ai Vollo bitstream by running:</p>
<pre><code class="language-sh">$ lspci -d 1ed9:
01:00.0 Processing accelerators: Myrtle.ai Device 100a
01:00.1 Processing accelerators: Myrtle.ai Device 000a
</code></pre>
<p>If the device has not been programmed with the vollo bitstream then you will need to program the board
over JTAG. See <a href="#programming-the-fpga-via-jtag">Programming the FPGA via JTAG</a> below.</p>
<p>Programming over PCIe is the preferred method of programming the board as it is faster than
programming over JTAG, and does not require a USB programming cable or for Vivado to be installed.</p>
<ol>
<li>
<p>Build and insert the ami driver.</p>
<pre><code class="language-sh">cd ami_kernel_driver
make
sudo insmod ami.ko
</code></pre>
<p>There may be compilation issues with your version of Linux. This has been checked with Rocky Linux
8.10. If there is an issue with your system, please contact us.</p>
</li>
<li>
<p>Once the kernel driver is loaded you can program the flash with <code>vollo-tool</code> (which uses
<code>ami_tool</code>). If you only have one board, <code>device_index</code> is <code>0</code>.</p>
<pre><code class="language-sh">sudo $VOLLO_SDK/bin/vollo-tool fpga-config overwrite-partition ${device_index:?} $VOLLO_SDK/bitstream/vollo-amd-v80-c6b32.pdi USER_IMAGE
</code></pre>
<p>There will be a progress bar and it should take around 5 minutes to program the flash. You will
need to power cycle the host for the new bitstream to be loaded.</p>
<div class="warning">
Sometimes a V80 host machine will hang on boot. You may need to force another power cycle of the
host to bring it back. Occasionally a power cycle isn't enough and you may need to turn the power
off for several minutes before turning it back on.
</div>
</li>
<li>
<p>If successful the device should now enumerate as a Myrtle.ai Vollo device:</p>
<pre><code class="language-sh">$ lspci -d 1ed9:
01:00.0 Processing accelerators: Myrtle.ai Device 100a
01:00.1 Processing accelerators: Myrtle.ai Device 000a
</code></pre>
</li>
</ol>
<h2 id="programming-the-fpga-via-jtag"><a class="header" href="#programming-the-fpga-via-jtag">Programming the FPGA via JTAG</a></h2>
<p>Programming a V80 board over JTAG is only needed if the board does not enumerate correctly.
Programming over PCIe is preferred. If the board does not enumerate or there is some other issue
with PCIe programming then JTAG programming is the only option.</p>
<p>This requires a USB cable to be connected to the accelerator card and Vivado to be installed on the
system so that the device can be programmed over JTAG.</p>
<ol>
<li>
<p>Download and install Vivado Lab Edition:</p>
<ul>
<li>
<p>Navigate to the Vivado Design Tools <a href="https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/vivado-design-tools.html">download page</a>.</p>
</li>
<li>
<p>Under "Vivado Lab Solutions" find "Vivado 2024.2: Lab Edition - Linux (TAR/GZIP - 1.99 GB)" (later versions may be available).</p>
</li>
<li>
<p>Download the file and extract it to a directory of your choice. You will need an AMD account
to download the file. You can create an account for free.</p>
</li>
<li>
<p>Pick a location to install <code>Vivado_Lab</code>, e.g. <code>/opt/Xilinx</code>, a user directory like <code>~/Xilinx</code> is
also fine:</p>
<pre><code class="language-sh">VIVADO_DIR=~/Xilinx
mkdir -p $VIVADO_DIR
</code></pre>
</li>
<li>
<p>Extract the tarball:</p>
<pre><code class="language-sh">tar xf Vivado_Lab_Lin_2024.2_1113_1001.tar
cd Vivado_Lab_Lin_2024.2_1113_1001/
</code></pre>
</li>
<li>
<p>Run the installer:</p>
<pre><code class="language-sh">./xsetup --agree 3rdPartyEULA,XilinxEULA --batch Install --edition "Vivado Lab Edition (Standalone)" --location $VIVADO_DIR
</code></pre>
</li>
<li>
<p>Check that installation was successful:</p>
<pre><code class="language-sh">$ $VIVADO_DIR/Vivado_Lab/2024.2/bin/vivado_lab -version
Vivado Lab Edition v2024.2 (64-bit)
SW Build 5239620 on Fri Nov 08 16:21:51 MST 2024
Tool Version Limit: 2024.11
Copyright 1986-2022 Xilinx, Inc. All Rights Reserved.
Copyright 2022-2024 Advanced Micro Devices, Inc. All Rights Reserved.
</code></pre>
</li>
</ul>
</li>
<li>
<p>Run the <code>program_v80_fpt.tcl</code> script to program the V80 board:</p>
<pre><code class="language-sh">sudo $VIVADO_DIR/Vivado_Lab/2024.2/bin/vivado_lab -mode batch -source ./flash_vollo-amd-v80-c6b32.tcl
</code></pre>
<p>This prints out a lot of lines while programming and takes about 10 minutes.</p>
<p>If you get an error like this:</p>
<pre><code class="language-sh">ERROR: [Labtoolstcl 44-469] There is no current hw_target.
</code></pre>
<p>Make sure that you ran <code>vivado_lab</code> with <code>sudo</code> and that the USB cable is plugged in.</p>
<p>After programming you must power cycle the host for the new bitstream to be loaded.</p>
<div class="warning">
Sometimes a V80 host machine will hang on boot. You may need to force another power cycle of the
host to bring it back. Occasionally a power cycle isn't enough and you may need to turn the power
off for several minutes before turning it back on.
</div>
</li>
<li>
<p>If successful the device should now enumerate as a Myrtle.ai Vollo device:</p>
<pre><code class="language-sh">$ lspci -d 1ed9:
01:00.0 Processing accelerators: Myrtle.ai Device 100a
01:00.1 Processing accelerators: Myrtle.ai Device 000a
</code></pre>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="programming-the-agilex.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="licensing.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="programming-the-agilex.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="licensing.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
